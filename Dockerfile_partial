FROM pytorch-base:latest

# Install PyTorch Geometric.

RUN CPATH=/usr/local/cuda/include:$CPATH \
 && LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH \
 && DYLD_LIBRARY_PATH=/usr/local/cuda/lib:$DYLD_LIBRARY_PATH

RUN /home/jupyteruser/conda/envs/py37/bin/pip install torch-scatter==latest+cu101 -f https://pytorch-geometric.com/whl/torch-1.5.0.html \
 && /home/jupyteruser/conda/envs/py37/bin/pip install torch-sparse==latest+cu101 -f https://pytorch-geometric.com/whl/torch-1.5.0.html \
 && /home/jupyteruser/conda/envs/py37/bin/pip install torch-cluster==latest+cu101 -f https://pytorch-geometric.com/whl/torch-1.5.0.html \
 && /home/jupyteruser/conda/envs/py37/bin/pip install torch-spline-conv==latest+cu101 -f https://pytorch-geometric.com/whl/torch-1.5.0.html \
 && /home/jupyteruser/conda/envs/py37/bin/pip install torch-geometric
